# short explaination for the code 
# num_cases_per_iteration is limited by the real case number
library("readxl")
source("Rscript/active_learning.R")
library("tidyverse")
source("Rscript/sim_output.R")
load("Data/glance_dec_data_test.R")

sampling_input <- read_excel("Data/Sampling_input.xlsx")
# have another table input for simulation number choice
total_nboot = 0
Sim_n = 50
num_cases_per_iteration = 10
total_iter = 150/num_cases_per_iteration
reduce_simulations_by_logic = TRUE
nburnin = 2
verbose = FALSE
inputparameter <- data.frame(reduce_simulations_by_logic,num_cases_per_iteration,total_iter, nburnin,total_nboot,verbose,Sim_n)

res_total = replicate(tail(sampling_input$sim_order, 1), data.frame())
for(i in 1:tail(sampling_input$sim_order, 1))
  {
  res_in_loop <- sim_output(df,sampling_input[i,],inputparameter)
  print(paste("res number",i,"is finished"))
  res_total[[i]] <- res_in_loop
}
if(Sim_n >1 & num_cases_per_iteration ==1){
  save(res_total, file = "Data/res_analysis_test1.R")
} else if(Sim_n ==1 & num_cases_per_iteration ==1){
  save(res_total, file = "Data/res_analysis_test2.R")
} else if(Sim_n >1 & num_cases_per_iteration == 10){
  save(res_total, file = "Data/res_analysis_test3.R")
}


 